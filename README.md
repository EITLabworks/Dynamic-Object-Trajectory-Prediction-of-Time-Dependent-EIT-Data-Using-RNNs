# Dynamic-object-trajectory-prediction-of-time-dependent-EIT-data-using-recurrent-neural-networks

This project presents a novel approach for dynamic image reconstruction of Electrical Impedance Tomography (EIT). This approach uses a data-driven reconstruction model consisting of a Variational Autoencoder (VAE) and a mapper with an integrated Long-Short-Term-Memory (LSTM) unit. The network has been specically designed for dynamic object trajectory prediction, allowing accurate tracking of an object's movement within the EIT tank and also predicting future object positions by exploiting temporal information in sequential EIT data. This approach was developed in both (2D and 3D) reconstructions of object motion. Data collection was performed using an EIT tank equipped with two electrode rings (each with 32 electrodes) and a Sciospec EIT device. In this project, the reconstruction network was trained and tested on synthetic data generated by FEM simulation (using pyEIT forward solver), experimental EIT data collected during 2D motion and experimental EIT data collected during 3D motion.

## Reconstruction network architecture

The architecture of the reconstruction model is based on two core components: a mapper with an integrated LSTM-layer at the output and a VAE decoder. The architectural design of the model is shown in figure...

The lstm mapper $\Xi$ processes temporal sequences of voltage measurements and maps it to the latent space h.
The VAE decoder $\Psi$ reconstructs the latent representation generated by the lstm mapper into a conductivity distribution.

The complete reconstruction network $\Gamma$ results from the concatenation of the individual mapping processes:

$$
\Gamma := \Xi \circ \Psi : \mathbf{V} \mapsto \mathbf{h} \mapsto \hat{\gamma}_{t+1}
$$

where $\mathbf{V}$ represents the voltage measurements at time $t$, $\mathbf{h}$ is the predicted latent space representation, and $\hat{\gamma}_{t+1}$ is the reconstructed conductivity distribution for time $t+1$.

## Training of reconstruction network

The training of the reconstruction network was carried out in two stages. In the first training stage, the VAE was trained unsupervised using synthetically generated conductivity distributions (for 2D and 3D space).
For the 2D space, a triangular mesh of the electrode plane of a cylindrical tank was used. In 3D space, a voxel-based method was used.
After the first training stage, the LSTM mapper was trained in a supervised manner. Here, the VAE encoder was used to generate a latent representation of known conductity distributions, which were used as labels for the supervised learning of the lstm mapper. The voltage sequence was then paired with the corresponding latent representation of the future conductivity distribution. 

## EIT data collection

The EIT data collection was performed both in a simulation environment using FEM-based simulation with the pyEIT package and in an experimental environment using an EIT water tank. For the 2D data collection, FEM simulation and experimental measurements in a single electrode plane were used, resulting in $32^2$ voltage data for each measurement frame. For the 3D data collection, experimental measurements with two electrode planes were performed, resulting in $64^2$ voltage data for each frame. The EIT data were collected using an acrylic ball following a given trajectory at discrete positions. 

In 2D space a circular, spiral, eight, polynomial, square trajectory were used. In 3D space, the trajectories uses were a helix, a spiral helix and a circular sine wave.

## Results 
